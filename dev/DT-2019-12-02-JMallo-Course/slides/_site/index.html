<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>From OPC to MDP</title>
    
    <link href="https://fonts.googleapis.com/css?family=Calistoga&display=swap" rel="stylesheet">

    <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
    <meta name="author" content="Hakim El Hattab">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/bitpay.css" id="theme">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}        });
        </script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


  </head>

  <body>

    $$\newcommand{\U}{ \textbf{u} }$$
$$\newcommand{\X}{ \textbf{x} }$$
$$\newcommand{\N}{ \mathbb{N} }$$
$$\newcommand{\R}{ \mathbb{R} }$$
$$\newcommand{\Y}{ \textbf{y} }$$

<div class="reveal">

	<!-- Any section element inside of this container is displayed as a slide -->
	<div class="slides">
		<img style="position:absolute;left: 1%;bottom: 20%;width: 20%;"src="https://cmc.deusto.eus/wp-content/themes/cmc/img/logo_CCM_subDerecha_v002.png" alt="">
<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->

	  <section>
			<h1>Numerics Experiments</h1>
			<h3>Jes√∫s Oroya</h3>
	  </section>

<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->

    <!-- Que es el control optimo -->
		<section>
	<h2>FEM in MATLAB</h2>
			<section>
				<h3>Create a model object</h3>
				<a href="https://es.mathworks.com/help/pde/ug/createpde.html#d117e42133">createpde</a> 
			</section>
			<section>
				<h3>Geometry Definition and Meshing</h3>
				<ul>
					<li><a href="https://es.mathworks.com/help/pde/ug/pde.pdemodel.importgeometry.html">importGeometry</a></li>
					<li><a href="">geometryFromMesh</a></li>
					<li><a href="">geometryFromEdges</a></li>
				</ul>
				$$ \text{ } \\ $$
			</section>

			<section>
				<h3>PDE Definition</h3>
				<ul>
					<li><a href="https://es.mathworks.com/help/pde/ug/pde.pdemodel.applyboundarycondition.html">applyBoundaryCondition</a></li>
					<li><a href="https://es.mathworks.com/help/pde/ug/pde.pdemodel.specifycoefficients.html">specifyCoefficients</a></li>
				</ul>
			</section>
			<section>
				<h3>FEM Matrices</h3>
				<li>
					<ul><a href="https://es.mathworks.com/help/pde/ug/assemblefematrices.html"></a></ul>
					$$ 
						d(u,x,y) u_t - \nabla .()
					$$
				</li>
			</section>
	</section>
</section>

		<section>
	<h1>How you can solve this?</h1>
	<h2>Bellman Equations</h2>

</section>
			<!-- 0 -->
	<section>
			<h2>Bellman Equations</h2>

		$$ \text{Let a function, }  V_l: \R^n  \rightarrow \R \text{ be defined as:}$$
		$$	V_l(\Y) = \min_{\{ \vec{\U}_l\} \in \mathcal{U}} \bigg[ \sum_{t=l}^{T-1} L(t,\X_t,\U_t) + S(\X_T) \bigg]  $$
		$$	s.t \ \ \X_{t+1} = f(t,\X_t,\U_t) \ | \ \forall t \in \{l, ... , T-1\}  \ | \ \X_l = \Y $$
		$$ \text{where } \vec{\U}_{l} = \{ \U_l,\U_{l+1}, ... , \U_{T-1}\} $$
		$$ \text{ }$$
	</section>
	<!-- 1 -->
	<section>
			<h2>Bellman Equations</h2>

		$$ \text{When } l=0\text{, the } V_0(\X_0) \text{ is the optimal control problem}  $$
		$$	V_0(\X_0) = \min_{\{ \vec{\U}_0\} \in \mathcal{U}} \bigg[ \sum_{t=0}^{T-1} L(t,\X_t,\U_t) + S(\X_T) \bigg]  $$
		$$	s.t \ \ \X_{t+1} = f(t,\X_t,\U_t) \ | \ \forall t \in \{0, ... , T-1\}  \ | \ \X_0 $$
		$$ \text{where } \vec{\U}_{0} = \{ \U_0,\U_{1}, ... , \U_{T-1}\} $$
		$$ \text{ }$$		
	</section>
	<!-- 2 -->
	<section>
			<h2>Bellman Equations</h2>

		We have a recursion law of function
		$$ V_l(\Y)$$ 
	</section>
	<!-- 3 -->
	<section>
			<h2>Bellman Equations</h2>

		We separate the first term
		$$	V_l(\Y) = \min_{\{ \vec{\U}_l\} \in \mathcal{U}^{T}} \bigg[ \textcolor{red}{L(l,\X_l,\U_l)} + \sum_{t=l+1}^{T-1} L(t,\X_t,\U_t) + S(\X_T) \bigg]  $$
		$$	s.t \ \ \X_{t+1} = f(t,\X_t,\U_t) \ | \ \forall t \in \{l, ... , T-1\}  \ | \ \X_l = \Y $$
		$$ \text{ }$$	
	</section>
	<!-- 4 -->
	<section>
			<h2>Bellman Equations</h2>

		We can obtain a sub-minimization problem with the same structure
			$$     V_l(\Y) = \min_{ \U_l \in \mathcal{U} }\Bigg[  L(l,\Y,\U_l)  +  
			\underbrace{\underbrace{\min_{\{\vec{\U}_{l+1}\} \in  \mathcal{U}^{T-1}}\Bigg[ \sum_{t=l+1}^{T-1} L(t,\X_t,\U_t) + S(\X_T) \Bigg]}_{    s.t \ \ \X_{t+1} = f(t,\X_t,\U_t) \ | \ \forall k \in \{l+1, ... , T-1\}  \ | \ \X_{l+1} = f(l,\Y,\U_l) }}_{V_{l+1}(f(l,\Y,\U_l))}
			 \Bigg] $$
	</section>
	<!-- 5 -->
	<section>
			<h2>Bellman Equations</h2>

		Finaly, we obtain a recurrence law
			$$     V_l(\Y) = \min_{ \U \in \mathcal{U}}\Bigg[  L(l,\Y,\U)  +  V_{l+1}(f(l,\Y,\U)) \Bigg] $$
			$$ \text{with:  } V_{T}(\Y) = S(\Y)$$
			<p class="fragment step-fade-in-then-out">$$\text{We obtain the }T-1\text{ minimization problems of one steps}$$ </p>
			$$ \text{ }$$

	</section>
		
	<!-- 6 -->
	<section>
		<h2>Bellman Equations</h2>

		<h3>Dynamic Programming Principle</h3>

			$$ \{ V_{T}(\Y) , V_{T-1}(\Y) , \dots , V_{1}(\Y) , V_{0}(\Y) \}$$
			$$ \text{We have a collection of functions}$$
			$$ \text{ }$$
	</section>	
	<!-- 7 -->
	<section>
			<h2>Bellman Equations</h2>

		$$ \text{Let a function, }  \Pi_l: \R^n  \rightarrow \R \text{ be defined as:}$$
			$$	\Pi_l(\Y) = \textcolor{red}{\arg \min}_{\{ \vec{\U}_l\} \in \mathcal{U}} \bigg[ \sum_{t=l}^{T-1} L(t,\X_t,\U_t) + S(\X_T) \bigg]  $$
			$$	s.t \ \ \X_{t+1} = f(t,\X_t,\U_t) \ | \ \forall t \in \{l, ... , T-1\}  \ | \ \X_l = \Y $$
			$$ \text{where } \vec{\U}_{l} = \{ \U_l,\U_{l+1}, ... , \U_{T-1}\} $$
			$$ \text{ }$$
		</section>

	<section>
			<h2>Bellman Equations</h2>

		<h3>Dynamic Programming Principle</h3>

			$$ \{ \Pi_{T}(\Y) , \Pi_{T-1}(\Y) , \dots , \Pi_{1}(\Y) , \Pi_{0}(\Y) \}$$
			$$ \text{We have optimal control for all state and time}$$
			$$ \text{ }$$
	</section>

		<section>
		<h1>What happens if our dynamic is stochastic?</h1>
		<h2>Markov decision process</h2>
	</section>
			<section>
		<h2>Markov decision process</h2>
	 	<p>Definition:</p> 

		<ul>
			<li>$$\text{State Space, } \mathcal{X} \text{ where } \forall (\X_t)_{t\in \N} \in \mathcal{X} $$</li>
			<li>$$\text{Control Space, }\mathcal{U} \text{ where } \forall (\U_t)_{t\in \N} \in \mathcal{U}$$</li>
			<li>$$ \text{Probability Distribution } \mathbb{P}(\X_{t+1}|\X_t,\U_t)$$</li>
		</ul>
		<br>
	</section>
	<!-- 1 -->
	<section>
		<h2>Markov decision process</h2>

			Minimization problem with restrictions
			\begin{gather}
				\min_{\{\U_t\} \in \mathcal{U}^T} J(\Y_0,\{\U_t\})  \Leftarrow \text{Cost function}
			\end{gather}
			
			subject to:
	
			\begin{gather} 
			\mathbb{P}(\X_{t+1}|\X_t,\U_t) \ | \ \forall t \in \{ 0,\dots,T-1\} \ |  \X_0 = \Y_0
			\end{gather}
			$$ \text{ } $$
	</section>
	<!-- 2 -->
	<section>
			<h2>Markov decision process</h2>

		Minimization problem with restrictions
			\begin{gather}
				\min_{\{\U_t\} \in \mathcal{U}^T} \mathbb{E}\bigg[ \underbrace{\sum_{t=0}^{T-1} L(t,\X_t,\U_t)}_{ \text{Path Cost}     } + 
												\underbrace{S(\X_T)                        }_{ \text{Terminal Cost} } \bigg| \X_0 = \Y_0 \bigg]
			\end{gather}
			
			subject to:
	
			\begin{gather} 
				\mathbb{P}(\X_{t+1}|\X_t,\U_t) \ | \ \forall t \in \{ 0,\dots,T-1\} \ 
			\end{gather}
		</section>		

		<section>
	<h1>How you can solve this?</h1>
	<h2>Bellman Equations</h2>

</section>
			<!-- 0 -->
	<section>
		<h2>Bellman Equations</h2>

		$$ \text{Let a function, }  V_l: \R^n  \rightarrow \R \text{ be defined as:}$$
		$$	\displaystyle V_l(\Y) = \min_{\{ \vec{\U}_l\} \in \mathcal{U}^T} \mathbb{E}_{\{ \vec{\X}_l \}}\bigg[ \sum_{t=l}^{T-1} L(t,\X_t,\U_t) + S(\X_T) \bigg| \X_l = \Y\bigg]  $$
		
		$$ \mathbb{P}(\X_{t+1}|\X_t,\U_t) \ | \ \forall t \in \{ l,\dots,T-1\} $$

		$$ \text{where } \vec{\U}_{l} = \{ \U_l,\U_{l+1}, ... , \U_{T-1}\}\text{ and, } \vec{\X}_{l} = \{ \X_l,\X_{l+1}, ... , \X_{T}\} $$
	</section> 
	<!-- 1 -->
	<section>
			$$ \text{When } l=0\text{, the } V_0 \text{ is the Markov decision process}  $$
			$$	
				V_0(\Y) = \min_{\{ \vec{\U}_0\} \in \mathcal{U}^T} 
				\mathbb{E}_{\{ \vec{\X}_0 \}}	\bigg[ \sum_{t=0}^{T-1} L(t,\X_t,\U_t) + S(\X_T)  \bigg| \X_0 = \Y \bigg]  
			$$
			\begin{gather} 
			\mathbb{P}(\X_{t+1}|\X_t,\U_t) \ | \ \forall t \in \{ 0,\dots,T-1\}
			\end{gather}
			$$ \text{where } \vec{\U}_{0} = \{ \U_0,\U_{1}, ... , \U_{T-1}\}\text{ and, } \vec{\X}_{0} = \{ \X_0,\X_{1}, ... , \X_{T}\} $$
			$$ \text{ }$$		
	</section>
	<!-- 2 -->
	<section>
			We have a recursion law of function
			$$ V_l(\Y)$$ 
	</section>
	<!-- 3 -->
	<section>
		We extract the first term from the sum
		
		$$ 
		V_l(\Y) =\min_{ \vec{\U_l} \in \mathcal{U}^T}  
				\mathbb{E}_{\{ \vec{\X}_l \}}\Bigg[  L(l,\X_l,\U_l)  +
				\bigg[ \sum_{t=l+1}^{T-1} L(t,\X_t,\U_t) + S(\X_T) \bigg] \Bigg| \X_l = \Y \Bigg] 
		$$
			
		$$ \mathbb{P}(\X_{t+1}|\X_t,\U_t) \ | \ \forall t \in \{ l,\dots,T-1\} $$
	</section>
	<!-- 4 -->
	<section>
			$$ 
			V_l(\Y) =\min_{ \vec{\U_l}\in \mathcal{U}^T}  
			\Bigg[
				\mathbb{E}_{\{ \vec{\X}_l \}}\big[  L(l,\X_l,\U_l) \big| \X_l = \Y  \big]  +
				\mathbb{E}_{\{ \vec{\X}_l \}}\Big[ \sum_{t=l+1}^{T-1} L(t,\X_t,\U_t) + S(\X_T) \Bigg| \X_l = \Y \Big]
			\Bigg] 
			$$

			\begin{gather} 
				\mathbb{P}(\X_{t+1}|\X_t,\U_t) \ | \ \forall t \in \{ l,\dots,T-1\} 
			\end{gather}
	</section>
	<!-- 5 -->
	<section>
			$$ 
			V_l(\Y) =\min_{ \vec{\U_l}\in \mathcal{U}^T}  
			\Bigg[
				 \textcolor{red}{L(l,\Y,\U_l)}   +
				\mathbb{E}_{\{ \vec{\X}_l \}}\Big[ \sum_{t=l+1}^{T-1} L(t,\X_t,\U_t) + S(\X_T) \Bigg| \X_l = \Y \Big]
			\Bigg] 
			$$

			\begin{gather} 
				\mathbb{P}(\X_{t+1}|\X_t,\U_t) \ | \ \forall t \in \{ l,\dots,T-1\} 
			\end{gather}
	</section>
	<!-- 6 -->
	<section>
		$$ 
		V_l(\Y) =\min_{ \U_l\in \mathcal{U}}  
		\Bigg[
				L(l,\Y,\U_l)   +
				\textcolor{red}{\min_{\{ \U_{l+1}\} \in \mathcal{U}^{T-l}}} 
				\mathbb{E}_{\{ \vec{\X}_l \}}\Big[ \sum_{t=l+1}^{T-1} L(t,\X_t,\U_t) + S(\X_T) \Bigg| \X_l = \Y \Big]
		\Bigg] 
		$$

		$$	\mathbb{P}(\X_{t+1}|\X_t,\U_t) \ | \ \forall t \in \{ l,\dots,T-1\} $$
		</section>

	<!-- 7 -->
	<section>
			We can obtain a sub-minimization problem with the same structure
			$$ 
			V_l(\Y) =\min_{\U_l} \big[ 
			L(l,\Y,\U_l)   +
			\textcolor{red}{\sum_{\X \in \mathcal{X}} \mathbb{P}(\X | \Y,\U_l)V_{l+1}(\X)\big]}
			$$
			with:
			$$ V_T(\Y) = S(\Y)$$
	</section>

	<section>
			<h3>Dynamic Programming Principle</h3>

			$$ \{ V_{T}(\Y) , V_{T-1}(\Y) , \dots , V_{1}(\Y) , V_{0}(\Y) \}$$
			$$ \text{We have a collection of functions,again}$$
			$$ \text{ }$$
	</section>
	<section>
			<h3>Dynamic Programming Principle</h3>

			$$ \{ \Pi_{T}(\Y) , \Pi_{T-1}(\Y) , \dots , \Pi_{1}(\Y) , \Pi_{0}(\Y) \}$$
			$$ \text{We have optimal control for all state and time}$$
			$$ \text{ }$$
	</section>


	</div>

  </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,
    
        margin: 0,
    
        width: 1440,
        height: 900,

        transition: 'fade', // none/fade/slide/convex/concave/zoom
        transitionSpeed: 'slow', // default/fast/slow

        // Optional reveal.js plugins
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'plugin/zoom-js/zoom.js', async: true },
          { src: 'plugin/notes/notes.js', async: true }
        ]
      });

    </script>

  </body>
</html>
