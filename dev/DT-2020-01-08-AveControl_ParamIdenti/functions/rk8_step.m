function [x] = rk8_step(f, t, x, dt,u1,u2 )

u = u1;
k_1 = f(t         ,x                                                                             ,u);

u = (1-4/27)*u1 + (4/27)*u2;
k_2 = f(t+dt*(4/27),x+(dt*4/27)*k_1                                                              ,u);

u = (1-2/9)*u1 + (2/9)*u2;
k_3 = f(t+dt*(2/9) ,x+  (dt/18)*(k_1+3*k_2)                                                      ,u);

u = (1-1/3)*u1 + (1/3)*u2;
k_4 = f(t+dt*(1/3) ,x+  (dt/12)*(k_1+3*k_3)                                                      ,u);

u = (1-1/2)*u1 + (1/2)*u2;
k_5 = f(t+dt*(1/2) ,x+   (dt/8)*(k_1+3*k_4)                                                      ,u);

u = (1-2/3)*u1 + 2/3*u2;
k_6 = f(t+dt*(2/3) ,x+  (dt/54)*(13*k_1-27*k_3+42*k_4+8*k_5)                                     ,u);

u = (1-1/6)*u1 + 1/6*u2;
k_7 = f(t+dt*(1/6) ,x+(dt/4320)*(389*k_1-54*k_3+966*k_4-824*k_5+243*k_6)                         ,u);

u = u2;
k_8 = f(t+dt       ,x+  (dt/20)*(-234*k_1+81*k_3-1164*k_4+656*k_5-122*k_6+800*k_7)               ,u);

u = (1-5/6)*u1 + 5/6*u2;
k_9 = f(t+dt*(5/6) ,x+ (dt/288)*(-127*k_1+18*k_3-678*k_4+456*k_5-9*k_6+576*k_7+4*k_8)            ,u);

u = u2;
k_10= f(t+dt       ,x+(dt/820)*(1481*k_1-81*k_3+7104*k_4-3376*k_5+72*k_6-5040*k_7-60*k_8+720*k_9),u);

x = x + dt/840*(41*k_1+27*k_4+272*k_5+27*k_6+216*k_7+216*k_9+41*k_10);
end